# Excel TUI

Replicating most of Excel's functionality in a simple terminal app.

## Formulas

In theory, all Excel formulas should function in this TUI as well.

### Order of Operations Parsing

*Generated by Llama 3.1 70B*

When evaluating an expression by a computer, the order of operations is typically handled using a technique called "Recursive Descent Parsing" or "Shunting-yard Algorithm". However, the most common approach used is the "Shunting-yard Algorithm" developed by Edsger Dijkstra in 1961.

Here's a simplified overview of how it works:

1. **Tokenization**: The expression is broken down into individual tokens, such as numbers, operators, and parentheses.
2. **Operator Precedence**: Each operator is assigned a precedence level, which determines the order in which they are evaluated. For example, multiplication and division have higher precedence than addition and subtraction.
3. **Output Queue**: An output queue is created to store the output of the expression.
4. **Operator Stack**: An operator stack is created to store operators that need to be evaluated.

The algorithm works as follows:

1. Read the next token from the input expression.
2. If the token is a number, add it to the output queue.
3. If the token is an operator, check the top of the operator stack.
	* If the top of the stack has higher precedence than the current operator, pop the top of the stack and add it to the output queue. Repeat this step until the top of the stack has lower precedence than the current operator.
	* Push the current operator onto the operator stack.
4. If the token is a left parenthesis, push it onto the operator stack.
5. If the token is a right parenthesis, pop operators from the operator stack and add them to the output queue until a left parenthesis is found. Remove the left parenthesis from the stack.
6. Repeat steps 2-5 until all tokens have been read from the input expression.
7. Pop any remaining operators from the operator stack and add them to the output queue.

The output queue now contains the expression in Reverse Polish Notation (RPN), which can be easily evaluated by a computer.

For example, consider the expression `3 + 4 * 2`. The Shunting-yard Algorithm would produce the following output queue:

`3 4 2 * +`

This RPN expression can be evaluated by a computer as follows:

1. Pop `3` from the queue and push it onto a stack.
2. Pop `4` from the queue and push it onto the stack.
3. Pop `2` from the queue and push it onto the stack.
4. Pop `2` and `4` from the stack, multiply them, and push the result onto the stack.
5. Pop `3` and the result of the multiplication from the stack, add them, and push the result onto the stack.

The final result is `11`, which is the correct evaluation of the original expression.

This algorithm is widely used in computer programming languages, including C, C++, Java, and Python, to evaluate expressions and handle the order of operations.

### Function Argument Handling

Add each function's arguments to the stack, evaluate each of them separately (until the comma), then make it such that they all wind up at the front of the stack, followed by the function's name.

## Specifications

These are the specs of Excel that eventually need to be met:
- https://support.microsoft.com/en-us/office/overview-of-formulas-in-excel-ecfdc708-9162-49e8-b993-c311f47ca173
- https://support.microsoft.com/en-us/office/calculation-operators-and-precedence-in-excel-48be406d-4975-4d31-b2b8-7af9e0e2878a
- https://support.microsoft.com/en-us/office/excel-specifications-and-limits-1672b34d-7043-467e-8e27-269d656771c3
- https://learn.microsoft.com/en-us/openspecs/office_standards/ms-xlsx/f780b2d6-8252-4074-9fe3-5d7bc4830968

